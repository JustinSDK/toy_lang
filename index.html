<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="首次嘗試打造的玩具語言，可用的指令組合都在底下的費式數列範例。">
    <meta property="og:locale" content="zh_TW">
    <meta property="og:title" content="Toy">
    <meta property="og:type" content="programming">
    <meta property="og:url" content="https://openhome.cc/Gossip/Computation/toy_lang/index.html">
    <meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
    <meta property="og:site_name" content="OPENHOME.CC">
    <meta property="og:description" content="首次嘗試打造的玩具語言，可用的指令組合都在底下的費式數列範例。">
    <title>Toy</title>
    <style type="text/css">
        textarea {
           width:100%;
           height:300px;
           resize:none;
           overflow:auto;
        }   
    </style>
  </head>
  <body> <a href="https://openhome.cc"><img src="https://openhome.cc/Gossip/images/caterpillar_small_front.jpg"></a>
    <p>相關程式碼可在 <a href="https://github.com/JustinSDK/toy_lang">Github</a> 找到，這是首次嘗試打造的玩具語言，文法大概是這樣：</p>
    <div><code><strong>&lt;primitive&gt;&nbsp;&nbsp; ::= NUMBER | ('.*')<br>
          &lt;variable&gt;&nbsp;&nbsp;&nbsp; ::= ([a-zA-Z_]+[a-zA-Z_0-9]*)<br>
        </strong></code></div>
    <code>
      <div><strong>&lt;factor&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::= </strong><strong>(-?)
          &lt;primitive&gt; | (-?) &lt;variable&gt; | &lt;expression&gt;</strong><strong>
        </strong></div>
      <div><strong>&lt;term&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::=
          &lt;factor&gt; {(*|/) &lt;factor&gt;}<br>
        </strong></div>
    </code>
    <div><code><strong> &lt;expression&gt;&nbsp; ::= &lt;term&gt; { (+|-)
          &lt;term&gt; }<br>
          &lt;assign&gt;&nbsp;&nbsp;&nbsp; &nbsp; ::= &lt;variable&gt; =
          &lt;expression&gt;<br>
          &lt;print&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::= "print"
          &lt;expression&gt;<br>
          &lt;until0&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::= "until0"
          &lt;expression&gt; "\n" { &lt;statement&gt; } "\n" "end" <br>
          &lt;statement&gt;&nbsp;&nbsp; ::= &lt;print&gt; | &lt;asign&gt; |
          &lt;until0&gt;<br>
          &lt;program&gt;&nbsp;&nbsp;&nbsp;&nbsp; ::= { &lt;statement&gt;
          }&nbsp; </strong></code></div>
    <p>可用的指令組合可參考底下的範例，運算式可使用括號，你的瀏覽器必須支援 ES6 模組。</p>
    <ul>
      <li>九九乘法表</li>
    </ul>
    <pre><strong><code>i = 9
until0 i
    j = 8
    a = 10 - i
    until0 j
        b = 10 - j
        print b
        print '*'
        print a
        print '='
        print b * a
        print '\t'
        j = j - 1
    end
    print '\n'
    i = i - 1
end</code></strong></pre>
    <ul>
      <li>費式數列</li>
    </ul>
    <pre><strong><code>print 'Fibonacci numbers\n'  
n = 10
fn1 = 1
fn2 = 1
print fn1
print ' '
print fn2
print ' '
until0 n
    fn = fn2 + fn1
    print fn
    print ' '
    fn1 = fn2
    fn2 = fn
    n = n - 1
end
print '\n'</code></strong></pre>
    <ul>
      <li>實驗室</li>
    </ul>
    <textarea id="code">print 'Hello, World'</textarea> <br>
    <br>
    <button id="run">執行</button> <br>
    <br>
    <textarea id="tty" style="background: #000;color:#fff;"></textarea>
    <script type="module">
    import {StmtTokenizer} from './js/tokenizer.js';
    import {AST} from './js/parser.js';
    document.getElementById('run').addEventListener('click', _ => {
        let code = document.getElementById('code').value;
        let tty = document.getElementById('tty');
        tty.textContent = new AST(new StmtTokenizer(code))
                            .evaluate()
                            .outputs
                            .map(output => `${output}`.replace('\\n', '\n').replace('\\t', '\t'))
                            .join('');
    });
</script> </body>
</html>
